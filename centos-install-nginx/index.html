<!DOCTYPE html><html><head><meta charset="utf-8"><title>Centos 编译安装 Nginx</title><meta name="keywords" content="Nginx,Nginx 安装,linux,nginx 编译安装,服务器搭建"><meta name="description" content="nginx是非常优秀的web服务器，centos8编译nginx时会遇到各种问题，例如编译参数的指定，源码的下载等，centos7编译安装与基本使用"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/style/main.css"><link rel="stylesheet" href="/style/fontawesome.css"><link rel="stylesheet" href="/style/katex.min.css"><link rel="stylesheet" href="/style/gitalk.css"><script async src="https://www.googletagmanager.com/gtag/js?id=G-2GM6102E19"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2GM6102E19")</script><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="codeover" type="application/atom+xml"><link rel="alternate" href="/rss2.xml" title="codeover" type="application/rss+xml"></head><body><div id="app" class="main"><div class="site-header-container"><div class="site-header"><div class="left"> <a href="https://www.codeover.cn"><img class="avatar" src="/images/avatar.png" alt="" width="32px" height="32px"></a><a href="https://www.codeover.cn"><h1 class="site-title">codeover</h1></a></div><div class="right"><i class="icon menu-switch icon-menu-outline"></i></div></div></div><div class="menu-container" style="height:0;opacity:0"><nav class="menu-list"> <a href="/" class="menu purple-link">首页</a> <a href="/tags/" class="menu purple-link">标签</a> <a href="/categories/" class="menu purple-link">分类</a> <a href="/archives/" class="menu purple-link">归档</a> <a href="/about/" class="menu purple-link">关于</a></nav></div><div class="content-container"><div class="post-detail"><h2 class="post-title">Centos 编译安装 Nginx</h2><div class="post-info post-detail-info"><span><i class="icon-calendar-outline"></i> 2022-04-18</span><span><i class="icon-pricetags-outline"></i> <a href="/tags/linux/">linux ，</a> <a href="/tags/Nginx/">Nginx</a></span></div><div class="post-content-wrapper"><div class="post-content"><p>Nginx (engine x) 是一个高性能的 HTTP 和反向代理 web 服务器, 同时也提供了 IMAP/POP3/SMTP 服务, Nginx是由伊戈尔·赛索耶夫为俄罗斯访问量第二的Rambler.ru站点（俄文：Рамблер）开发的。</p><p>Nginx 官网：<a target="_blank" rel="noopener" href="https://nginx.org/">https://nginx.org</a></p><h3 id="1-下载源码"><a href="#1-下载源码" class="headerlink" title="1.下载源码"></a>1.下载源码</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载</span></span><br><span class="line">wget https://nginx.org/download/nginx-1.20.2.tar.gz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压</span></span><br><span class="line">tar xfs nginx-1.20.2.tar.gz</span><br><span class="line">cd nginx-1.20.2</span><br></pre></td></tr></tbody></table></figure><h3 id="2-编译安装"><a href="#2-编译安装" class="headerlink" title="2.编译安装"></a>2.编译安装</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加用户和用户组 （可自行修改）</span></span><br><span class="line">groupadd www</span><br><span class="line">useradd -g www www -M -s /sbin/nologin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装依赖</span></span><br><span class="line">yum install pcre-devel openssl-devel -y</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置</span></span><br><span class="line">./configure --user=www --group=www --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-http_gzip_static_module --with-http_sub_module --with-pcre</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编译并安装</span></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></tbody></table></figure><blockquote><p>注意：Centos 镜像已停止服务，<code>yum install</code> 安装 <code>devel</code> 软件时，如报错无法安装可尝试将 <code>/etc/yum.repos.d/</code> 目录下的 <code>CentOS-Base.repo.rpmsave</code> 中的文件内容覆盖至 <code>CentOS-Linux-BaseOS.repo</code> ，<code>CentOS-AppStream.repo.rpmsave</code> 覆盖至 <code>CentOS-Linux-AppStream.repo</code>，操作前请注意备份</p></blockquote><p>其中 <code>user</code> 与 <code>group</code> 用于指定运行 nginx 的用户，<code>prefix</code> 指定安装路径，可根据需要自行修改</p><h3 id="3-创建软连接"><a href="#3-创建软连接" class="headerlink" title="3.创建软连接"></a>3.创建软连接</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/nginx/sbin/nginx /usr/bin/nginx</span><br></pre></td></tr></tbody></table></figure><h3 id="4-验证"><a href="#4-验证" class="headerlink" title="4.验证"></a>4.验证</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx</span><br></pre></td></tr></tbody></table></figure><p>输出如下<br><img src="https://cdn.codeover.cn/img/625d6710239250f7c5a8b4ff.jpg-imageFop" alt="输出截图"></p><h3 id="5-配置"><a href="#5-配置" class="headerlink" title="5.配置"></a>5.配置</h3><ol><li><code>worker_processes</code> 启动进程数，修改为 <code>auto</code></li><li><code>worker_connections</code> 单个工作进程可以允许同时建立外部连接的数量， 修改为 65535</li><li>运行 <code>ulimit -SHn 65535</code> 修改系统资源限制，并添加至 <code>/etc/profile</code> 文件底部</li></ol><h3 id="6-常用命令"><a href="#6-常用命令" class="headerlink" title="6.常用命令"></a>6.常用命令</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动</span></span><br><span class="line">nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">停止</span></span><br><span class="line">nginx -s stop</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启</span></span><br><span class="line">nginx -s quit</span><br><span class="line">nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">平滑重启</span></span><br><span class="line">nginx -s reload</span><br></pre></td></tr></tbody></table></figure><h3 id="7-配置-php"><a href="#7-配置-php" class="headerlink" title="7. 配置 php"></a>7. 配置 php</h3><p>php 是世界上最好的编程语言，如需在 nginx 中使用 php，可参考这盘文章：<a href="https://www.codeover.cn/centos-install-php/">https://www.codeover.cn/centos-install-php/</a></p><h3 id="8-日志配置"><a href="#8-日志配置" class="headerlink" title="8. 日志配置"></a>8. 日志配置</h3><p>网站访问日志是非常有用的，我们会常用日志查看网站访问情况，以及对网站进行分析，nginx 的日志配置可参考这边文章：<a href="https://www.codeover.cn/nginx-log-config/">https://www.codeover.cn/nginx-log-config/</a></p><h3 id="9-负载均衡"><a href="#9-负载均衡" class="headerlink" title="9. 负载均衡"></a>9. 负载均衡</h3><p>在网站压力日益增加后，我们会引入负载均衡来分散服务压力，nginx 的负载均衡配置可查看这篇文章：<a href="https://www.codeover.cn/nginx-balancing/">https://www.codeover.cn/nginx-balancing/</a></p><h3 id="10-虚拟网站配置"><a href="#10-虚拟网站配置" class="headerlink" title="10. 虚拟网站配置"></a>10. 虚拟网站配置</h3><p>我们的服务器想要运行网站，都需要在 nginx 中注册，即配置 nginx web server，在 nginx web server 配置中，每个 server 都对应了一个网站，且相互独立，具体配置方式可参考本文：<a href="https://www.codeover.cn/nginx-server-config/">https://www.codeover.cn/nginx-server-config/</a></p><h3 id="11-gzip-压缩"><a href="#11-gzip-压缩" class="headerlink" title="11. gzip 压缩"></a>11. gzip 压缩</h3><p>为提高网页加载速度，启用 <code>gzip</code> 缩减资源的大小是非常常见的手段。现代浏览器基本均支持 <code>gzip</code> 压缩，并会为HTTP请求自动协商此类压缩。gzip 的具体配置方法可参考此文章：<a href="https://www.codeover.cn/nginx-gzip/">https://www.codeover.cn/nginx-gzip/</a></p></div><div class="top-div"><ol class="top-box"><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#1-%E4%B8%8B%E8%BD%BD%E6%BA%90%E7%A0%81"><span class="top-box-text">1.下载源码</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#2-%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85"><span class="top-box-text">2.编译安装</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#3-%E5%88%9B%E5%BB%BA%E8%BD%AF%E8%BF%9E%E6%8E%A5"><span class="top-box-text">3.创建软连接</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#4-%E9%AA%8C%E8%AF%81"><span class="top-box-text">4.验证</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#5-%E9%85%8D%E7%BD%AE"><span class="top-box-text">5.配置</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#6-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="top-box-text">6.常用命令</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#7-%E9%85%8D%E7%BD%AE-php"><span class="top-box-text">7. 配置 php</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#8-%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE"><span class="top-box-text">8. 日志配置</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#9-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"><span class="top-box-text">9. 负载均衡</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#10-%E8%99%9A%E6%8B%9F%E7%BD%91%E7%AB%99%E9%85%8D%E7%BD%AE"><span class="top-box-text">10. 虚拟网站配置</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#11-gzip-%E5%8E%8B%E7%BC%A9"><span class="top-box-text">11. gzip 压缩</span></a></li></ol></div></div></div><div class="next-post"><a class="purple-link" href="/centos-install-apache/"><h3 class="post-title"> 下一篇：Centos 编译安装 Apache</h3></a></div></div><div id="gitalk-container"></div><footer><div class="site-footer"><div class="social-container"><a href="https://github.com/f-dong" target="_blank"><i class="fab fa-github"></i></a></div> Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <a href="https://github.com/f-dong/hexo-theme-minimalism" target="_blank">Theme</a> | <a class="icp" href="https://beian.miit.gov.cn" target="_blank">豫ICP备2022011962号</a></div></footer></div><script src="/js/jquery.min.js"></script><script>$(".menu-switch").click(function(){if($(this).hasClass("icon-menu-outline"))$(this).removeClass(" icon-menu-outline ").addClass("icon-close-outline"),$(".menu-container").css("opacity","1").css("height","auto");else{$(this).addClass(" icon-menu-outline ").removeClass("icon-close-outline"),$(".menu-container").css("opacity","0");var s=$(this);setTimeout(function(){s.hasClass("icon-menu-outline")&&$(".menu-container").css("height","0")},600)}})</script><script src="/js/gitalk.min.js"></script><script>var gitalk=new Gitalk({clientID:"eaa8ec37487184406145",clientSecret:"77f9955d0267c1331df7cc706cfa385d2befb9c6",repo:"blog",owner:"f-dong",admin:["f-dong"],id:location.pathname.slice(1,location.pathname.lastIndexOf("/")).substring(0,49),distractionFreeMode:!1,createIssueManually:!0});gitalk.render("gitalk-container")</script><script src="/js/gitalk.min.js"></script><script>var gitalk=new Gitalk({clientID:"eaa8ec37487184406145",clientSecret:"77f9955d0267c1331df7cc706cfa385d2befb9c6",repo:"blog",owner:"f-dong",admin:["f-dong"],id:location.pathname.slice(1,location.pathname.lastIndexOf("/")).substring(0,49),distractionFreeMode:!1});gitalk.render("gitalk-container")</script><script>
        // 代码语言
        $(function () {
          $('code').each(function () {
            var code_language = $(this).attr('class');

            if (!code_language) {
              return true;
            }
            var lang_name = code_language.replace("line-numbers", "").trim().replace("highlight", "").trim().replace("language-", "").trim();

            $(this).attr('data-content-after', lang_name || 'CODE');
          });
          $('.highlight').each(function () {
            var code_language = $(this).attr('class');

            if (!code_language) {
              return true;
            }
            var lang_name = code_language.replace("highlight", "").trim();

            $(this).attr('data-content-after', lang_name || 'CODE');
          });
        });

        let mainNavLinks = document.querySelectorAll(".top-box a");

        window.addEventListener("scroll", event => {
          let fromTop = window.scrollY + 100;

          mainNavLinks.forEach((link, index) => {
            let section = document.getElementById(decodeURI(link.hash).substring(1));
            let nextSection = null
            if (mainNavLinks[index + 1]) {
              nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
            }
            if (section.offsetTop <= fromTop) {
              if (nextSection) {
                if (nextSection.offsetTop > fromTop) {
                  link.classList.add("current");
                } else {
                  link.classList.remove("current");
                }
              } else {
                link.classList.add("current");
              }
            } else {
              link.classList.remove("current");
            }
          });
        });
    </script></body></html>