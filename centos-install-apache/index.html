<!DOCTYPE html><html><head><meta charset="utf-8"><title>Centos 编译安装 Apache</title><meta name="keywords" content="Apache,Apache安装,linux,Apache 编译安装,服务器搭建"><meta name="description" content="本文介绍centos下如何编译安装apache，centos8安装Apache，同时centos7也可，通过编译源代码方式安装，同时编译安装依赖apr和apr-util，并进行简单配置。"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/style/main.css"><link rel="stylesheet" href="/style/fontawesome.css"><link rel="stylesheet" href="/style/katex.min.css"><link rel="stylesheet" href="/style/gitalk.css"><script async src="https://www.googletagmanager.com/gtag/js?id=G-2GM6102E19"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2GM6102E19")</script><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="codeover" type="application/atom+xml"><link rel="alternate" href="/rss2.xml" title="codeover" type="application/rss+xml"></head><body><div id="app" class="main"><div class="site-header-container"><div class="site-header"><div class="left"> <a href="https://www.codeover.cn"><img class="avatar" src="/images/avatar.png" alt="" width="32px" height="32px"></a><a href="https://www.codeover.cn"><h1 class="site-title">codeover</h1></a></div><div class="right"><i class="icon menu-switch icon-menu-outline"></i></div></div></div><div class="menu-container" style="height:0;opacity:0"><nav class="menu-list"> <a href="/" class="menu purple-link">首页</a> <a href="/tags/" class="menu purple-link">标签</a> <a href="/categories/" class="menu purple-link">分类</a> <a href="/archives/" class="menu purple-link">归档</a> <a href="/about/" class="menu purple-link">关于</a></nav></div><div class="content-container"><div class="post-detail"><h2 class="post-title">Centos 编译安装 Apache</h2><div class="post-info post-detail-info"><span><i class="icon-calendar-outline"></i> 2022-04-16</span><span><i class="icon-pricetags-outline"></i> <a href="/tags/linux/">linux ，</a> <a href="/tags/Apache/">Apache</a></span></div><div class="post-content-wrapper"><div class="post-content"><p>Apache(音译为阿帕奇)是世界使用排名第一的 Web 服务器软件。它可以运行在几乎所有广泛使用的计算机平台上，由于其跨平台和安全性被广泛使用，是最流行的 Web 服务器端软件之一。它快速、可靠并且可通过简单的 API 扩充，将 Perl/Python 等解释器编译到服务器中。</p><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><h3 id="下载安装文件"><a href="#下载安装文件" class="headerlink" title="下载安装文件"></a>下载安装文件</h3><p>使用 <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/">清华大学开源软件镜像站</a> 下载安装文件，依次打开链接选择最新本 <code>tar.gz</code> 格式安装包，鼠标右键复制下载地址</p><ol><li><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/apache/apr/">apr</a></li><li><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/apache/apr/">apr-util</a></li><li><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/apache/httpd/">httpd</a></li></ol><h3 id="安装依赖（centos最小安装模式）"><a href="#安装依赖（centos最小安装模式）" class="headerlink" title="安装依赖（centos最小安装模式）"></a>安装依赖（centos最小安装模式）</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc gcc-c++ -y</span><br><span class="line">yum install make -y</span><br><span class="line">yum install expat-devel -y</span><br></pre></td></tr></tbody></table></figure><h2 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h2><h3 id="安装-apr"><a href="#安装-apr" class="headerlink" title="安装  apr"></a>安装 apr</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载安装文件</span></span><br><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/apache/apr/apr-1.7.0.tar.gz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压缩安装文件</span></span><br><span class="line">tar xsf apr-1.7.0.tar.gz</span><br><span class="line">cd apr-1.7.0</span><br><span class="line">./configure --prefix=/usr/local/apr</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></tbody></table></figure><h3 id="安装-apr-util"><a href="#安装-apr-util" class="headerlink" title="安装  apr-util"></a>安装 apr-util</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/apache/apr/apr-util-1.6.1.tar.gz</span><br><span class="line">tar xsf apr-util-1.6.1.tar.gz</span><br><span class="line">cd apr-util-1.6.1</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></tbody></table></figure><h3 id="安装-apache"><a href="#安装-apache" class="headerlink" title="安装  apache"></a>安装 apache</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/apache/httpd/httpd-2.4.53.tar.gz</span><br><span class="line">tar xsf httpd-2.4.53.tar.gz</span><br><span class="line">cd httpd-2.4.53</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装 pcre-devel</span></span><br><span class="line">rpm -qa | grep pcre-devel || yum install pcre-devel -y</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">安装 openssl</span></span><br><span class="line">rpm -qa | grep openssl-devel || yum install openssl-devel -y</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建编译文件</span></span><br><span class="line">./configure --prefix=/usr/local/httpd --sysconfdir=/usr/local/httpd/etc/ --enable-so --enable-ssl --enable-cli --enable-rewrite --enable-modules=most --enable-mpms-shared=all --with-npm=prefok --with-zlib --with-pcre --with-apr=/usr/local/apr --with-apr-util=/usr/local/apr-util</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></tbody></table></figure><p>进入 apache 配置目录 <code>cd /usr/local/httpd/etc/</code>，编辑 <code>httpd.conf</code>，解除 200 行左右的 <code>ServerName</code> 的注释</p><p><img src="https://cdn.codeover.cn/img/625c27fe239250f7c568334f.jpg-imageFop" alt="取消注释ServerName"></p><h2 id="xxxxxxxxxx-启动nginx​-停止nginx-s-stop​-重启nginx-s-quitnginx​-平滑重启nginx-s-reloadshell"><a href="#xxxxxxxxxx-启动nginx​-停止nginx-s-stop​-重启nginx-s-quitnginx​-平滑重启nginx-s-reloadshell" class="headerlink" title="xxxxxxxxxx&nbsp;# 启动nginx​# 停止nginx -s stop​# 重启nginx -s quitnginx​# 平滑重启nginx -s reloadshell"></a>xxxxxxxxxx&nbsp;# 启动nginx​# 停止nginx -s stop​# 重启nginx -s quitnginx​# 平滑重启nginx -s reloadshell</h2><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/httpd</span><br><span class="line">./bin/apachectl start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">关闭防火墙</span></span><br><span class="line">systemctl stop firewalld</span><br></pre></td></tr></tbody></table></figure><h3 id="多站点配置"><a href="#多站点配置" class="headerlink" title="多站点配置"></a>多站点配置</h3><p>将 <code>httpd.conf</code> 第 243 行左右的 <code>AllowOverride None</code> 修改为 <code>AllowOverride All</code></p><p><img src="https://cdn.codeover.cn/img/625c2a61239250f7c56de08e.jpg-imageFop" alt="修改配置截图"></p><p>将 <code>httpd.conf</code> 第 480 行左右的 <code>Include etc//extra/httpd-vhosts.conf</code> 解除注释<br>修改 <code>extra/httpd-vhosts.conf</code>，文件内容如下</p><p><img src="https://cdn.codeover.cn/img/625c2c3e239250f7c571bfaa.jpg-imageFop" alt="vhosts内容"></p><figure class="highlight apache"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">&lt;VirtualHost *<span class="number">:80</span>&gt;</span></span><br><span class="line">    <span class="attribute">ServerAdmin</span> webmaster@dummy-host.example.com</span><br><span class="line">    <span class="comment"># 网站根路径</span></span><br><span class="line">    <span class="attribute">DocumentRoot</span> <span class="string">"/usr/local/httpd/docs/dummy-host.example.com"</span></span><br><span class="line">    <span class="comment"># 网站域名</span></span><br><span class="line">    <span class="attribute">ServerName</span> dummy-host.example.com</span><br><span class="line">    <span class="attribute">ServerAlias</span> www.dummy-host.example.com</span><br><span class="line">    <span class="comment"># 日志文件</span></span><br><span class="line">    <span class="attribute">ErrorLog</span> <span class="string">"logs/dummy-host.example.com-error_log"</span></span><br><span class="line">    <span class="attribute">CustomLog</span> <span class="string">"logs/dummy-host.example.com-access_log"</span> common</span><br><span class="line"><span class="section">&lt;/VirtualHost&gt;</span></span><br></pre></td></tr></tbody></table></figure><p>重启 apache 即可 <code>/usr/local/httpd/bin/apachectl reset</code></p></div><div class="top-div"><ol class="top-box"><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="top-box-text">准备工作</span></a><ol class="top-box-child"><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E6%96%87%E4%BB%B6"><span class="top-box-text">下载安装文件</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%EF%BC%88centos%E6%9C%80%E5%B0%8F%E5%AE%89%E8%A3%85%E6%A8%A1%E5%BC%8F%EF%BC%89"><span class="top-box-text">安装依赖（centos最小安装模式）</span></a></li></ol></li><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85"><span class="top-box-text">开始安装</span></a><ol class="top-box-child"><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%AE%89%E8%A3%85-apr"><span class="top-box-text">安装 apr</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%AE%89%E8%A3%85-apr-util"><span class="top-box-text">安装 apr-util</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%AE%89%E8%A3%85-apache"><span class="top-box-text">安装 apache</span></a></li></ol></li><li class="top-box-item top-box-level-2"><a class="top-box-link" href="#xxxxxxxxxx-%E5%90%AF%E5%8A%A8nginx%E2%80%8B-%E5%81%9C%E6%AD%A2nginx-s-stop%E2%80%8B-%E9%87%8D%E5%90%AFnginx-s-quitnginx%E2%80%8B-%E5%B9%B3%E6%BB%91%E9%87%8D%E5%90%AFnginx-s-reloadshell"><span class="top-box-text">xxxxxxxxxx # 启动nginx​# 停止nginx -s stop​# 重启nginx -s quitnginx​# 平滑重启nginx -s reloadshell</span></a><ol class="top-box-child"><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%90%AF%E5%8A%A8"><span class="top-box-text">启动</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%A4%9A%E7%AB%99%E7%82%B9%E9%85%8D%E7%BD%AE"><span class="top-box-text">多站点配置</span></a></li></ol></li></ol></div></div></div></div><div id="gitalk-container"></div><footer><div class="site-footer"><div class="social-container"><a href="https://github.com/f-dong" target="_blank"><i class="fab fa-github"></i></a></div> Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <a href="https://github.com/f-dong/hexo-theme-minimalism" target="_blank">Theme</a> | <a class="icp" href="https://beian.miit.gov.cn" target="_blank">豫ICP备2022011962号</a></div></footer></div><script src="/js/jquery.min.js"></script><script>$(".menu-switch").click(function(){if($(this).hasClass("icon-menu-outline"))$(this).removeClass(" icon-menu-outline ").addClass("icon-close-outline"),$(".menu-container").css("opacity","1").css("height","auto");else{$(this).addClass(" icon-menu-outline ").removeClass("icon-close-outline"),$(".menu-container").css("opacity","0");var s=$(this);setTimeout(function(){s.hasClass("icon-menu-outline")&&$(".menu-container").css("height","0")},600)}})</script><script src="/js/gitalk.min.js"></script><script>var gitalk=new Gitalk({clientID:"eaa8ec37487184406145",clientSecret:"77f9955d0267c1331df7cc706cfa385d2befb9c6",repo:"blog",owner:"f-dong",admin:["f-dong"],id:location.pathname.slice(1,location.pathname.lastIndexOf("/")).substring(0,49),distractionFreeMode:!1,createIssueManually:"true"});gitalk.render("gitalk-container")</script><script src="/js/gitalk.min.js"></script><script>var gitalk=new Gitalk({clientID:"eaa8ec37487184406145",clientSecret:"77f9955d0267c1331df7cc706cfa385d2befb9c6",repo:"blog",owner:"f-dong",admin:["f-dong"],id:location.pathname.slice(1,location.pathname.lastIndexOf("/")).substring(0,49),distractionFreeMode:!1});gitalk.render("gitalk-container")</script><script>
        // 代码语言
        $(function () {
          $('code').each(function () {
            var code_language = $(this).attr('class');

            if (!code_language) {
              return true;
            }
            var lang_name = code_language.replace("line-numbers", "").trim().replace("highlight", "").trim().replace("language-", "").trim();

            $(this).attr('data-content-after', lang_name || 'CODE');
          });
          $('.highlight').each(function () {
            var code_language = $(this).attr('class');

            if (!code_language) {
              return true;
            }
            var lang_name = code_language.replace("highlight", "").trim();

            $(this).attr('data-content-after', lang_name || 'CODE');
          });
        });

        let mainNavLinks = document.querySelectorAll(".top-box a");

        window.addEventListener("scroll", event => {
          let fromTop = window.scrollY + 100;

          mainNavLinks.forEach((link, index) => {
            let section = document.getElementById(decodeURI(link.hash).substring(1));
            let nextSection = null
            if (mainNavLinks[index + 1]) {
              nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
            }
            if (section.offsetTop <= fromTop) {
              if (nextSection) {
                if (nextSection.offsetTop > fromTop) {
                  link.classList.add("current");
                } else {
                  link.classList.remove("current");
                }
              } else {
                link.classList.add("current");
              }
            } else {
              link.classList.remove("current");
            }
          });
        });
    </script></body></html>